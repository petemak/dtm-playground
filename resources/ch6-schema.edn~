;; Basic entities 
[{:db/id #db/id [:db.part/db]
  :db/ident :label
  :db/valueType :db.type/string
  :db/cardinality :db.cardinality/one
  :db/doc "display label of an entity"
  :db.install/_attribute :db.part/db}

 {:db/id #db/id [:db.part/db]
  :db/ident :db.part/account
  :db.install/_partition :db.part/db}]

[{:db/id #db/id [:db.part/db]
  :db/ident :user/login
  :db/valueType :db.type/string
  :db/cardinality :db.cardinality/one
  :db/doc "user's login name and display name"
  :db/unique :db.unique/identity
  :db.install/_attribute :db.part/db}

 {:db/id #db/id [:db.part/db]
  :db/ident :user/first-name
  :db/valueType :db.type/string
  :db/cardinality :db/cardinality/one
  :db/doc "Users first name"
  :db.install/_partition :db.part/db}

 {:db/id #db/id [:db.part/db]
  :db/ident :user/last-name
  :db/valueType :db.type/string
  :db/cardinality :db/cardinality/one
  :db/doc "Users last name"
  :db.install/_partition :db.part/db} 

 {:db/id #db/id [:db.part/db]
  :db/ident :user/password
  :db/valueType :db.type/string
  :db/cardinality :db.cardinality/one
  :db/doc "crypted pasword"
  :db.install/_attribute :db.part/db}

 {:db/id #db/id [:db.part/db]
  :db/ident :user/email
  :db/valueType :db.type/string
  :db/cardinality :db.cardinality/one
  :db/doc "User's email address"
  :db/unique :db.unique/value
  :db.install/_attribute :db.part/db}

 {:db/id #db/id [:db.part/db]
  :db/ident :user/account
  :db/valueType :db.type/ref
  :db/cardinality :db.cardinality/one
  :db/isComponent true
  :db/doc "The account linked to the user"
  :db.install/_attribute :db.part/db}]

;; Account schema
[{:db/id #db/id [:db.part/db]
  :db/ident :account/type
  :db/valueType :db.type/ref
  :db/cardinality :db.cardinality/one
  :db/doc "account type (eg paid, free), an enum"
  :db.install/_attribute :db.part/db}

 {:db/id #db/id [:db.part/db]
  :db/ident :account/current-balance
  :db/valueType :db.type/bigdec
  :db/cardinality :db.cardinality/one
  :db/doc "current balance of the account"
  :db/index true
  :db/noHistory true
  :db.install/_attribute :db.part/db}

 {:db/id #db/id [:db.part/db]
  :db/ident :account/transaction
  :db/valueType :db.type/ref
  :db/cardinality :db.cardinality/many
  :db/isComponent true
  :db/doc "transactions (payments and charges) against the account"
  :db.install/_attribute :db.part/db}

 {:db/id #db/id [:db.part/db]
  :db/ident :transaction/type
  :db/valueType :db.type/ref
  :db/cardinality :db.cardinality/one
  :db/doc "transaction type (eg charge, payment, adjustment) - an enum"
  :db.install/_attribute :db.part/db}

 {:db/id #db/id [:db.part/db]
  :db/ident :transaction/amount
  :db/valueType :db.type/bigdec
  :db/cardinality :db.cardinality/one
  :db/doc "amount of the transaction"
  :db.install/_attribute :db.part/db}

 ;; Account enums
 {:db/id #db/id [:db.part/account]
  :db/ident :account.type/free
  :label "Free account"}

 {db/id #db/id [:db.part/account]
  :db/ident :account.type/paid
  :label "Paid account"}

 {:db/id #db/id [:db.part/account]
  :db/ident :transaction.type/charge
  :label "Charge"}

 {:db/id #db/id [:db.part/account]
  :db/ident :transaction.type/payment
  :label "Payment"}

 {:db/id #db/id [:db.part/account]
  :db/ident :transaction.type/adjustment
  :label "Adjustment"}]
